# examples/authelia/Makefile

.PHONY: up down logs clean restart health test-headers

up:
	@echo "ğŸš€ Starting Authelia + Dagster stack..."
	docker-compose up --build -d
	@echo ""
	@echo "âœ… Stack is up!"
	@echo ""
	@echo "ğŸ“ Access URLs:"
	@echo "   Dagster:         http://127.0.0.1:3000"
	@echo "   Authelia:        http://127.0.0.1:9091"
	@echo ""
	@echo "ğŸ‘¤ Test Users (password: password123):"
	@echo "   Username: admin    â†’ Role.ADMIN"
	@echo "   Username: editor   â†’ Role.EDITOR"
	@echo "   Username: launcher â†’ Role.LAUNCHER"
	@echo "   Username: viewer   â†’ Role.VIEWER"
	@echo ""
	@echo "â³ Wait ~20s for LDAP seed to complete..."
	@echo ""
	@echo "ğŸ” Check status:"
	@echo "   make logs-ldap     # LDAP initialization"

down:
	@echo "ğŸ›‘ Stopping stack..."
	docker-compose down

logs:
	docker-compose logs -f dagster authelia

logs-ldap:
	docker-compose logs -f ldap ldap-seed

clean:
	@echo "ğŸ§¹ Cleaning up volumes..."
	docker-compose down -v
	rm -rf authelia/db.sqlite3 authelia/notification.txt

restart: down up

health:
	@echo "ğŸ¥ Health check..."
	@docker-compose ps